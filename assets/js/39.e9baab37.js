(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{273:function(e,s,t){"use strict";t.r(s);var n=t(47),a=Object(n.a)({},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"use-gitlab-ci-to-run-free-scheduled-jobs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#use-gitlab-ci-to-run-free-scheduled-jobs","aria-hidden":"true"}},[e._v("#")]),e._v(" Use GitLab-CI to run free scheduled jobs")]),e._v(" "),t("p",[e._v("In this topic, I'll introduce how to run scheduled job with GitLab-CI, without the need to have a server running cron job or other application.")]),e._v(" "),t("p",[e._v("GitLab-CI is a continuous integration/deployment tool, it will trigger some scripts (such as build, test, deployment) when there is new deployment or defined interval. GitLab-CI has a free quota of 2,000 minutes running time, which is 1 hour everyday.")]),e._v(" "),t("p",[e._v("If you prefer GitHub than GitLab, Travis CI also offers similar tool for free.")]),e._v(" "),t("p",[e._v("GitLab-CI and Travis CI both support scheduled jobs, however, GitLab-CI supports as often as every hour, while Travis supports as often as every day.")]),e._v(" "),t("p",[e._v("So, why we need to run scheduled job? Here are the use cases:")]),e._v(" "),t("ol",[t("li",[e._v("I need a job to monitor Bitcoin price, when the price is higher or lower than some price, it will notify me to make transaction")]),e._v(" "),t("li",[e._v("I need a job to monitor price of a product, when it's lower than a certain price, it will notify me to make order")]),e._v(" "),t("li",[e._v("I need a job to keep Heroku app up and running (Prevent it to sleep)")])]),e._v(" "),t("p",[e._v("First, create a "),t("code",[e._v(".gitlab-ci.yml")]),e._v(" file in your repo")]),e._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("test")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("script")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" bash scripts/script_a.sh\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[e._v("This file defined a task called "),t("code",[e._v("test")]),e._v(", and specified it to run "),t("code",[e._v("script_a.sh")]),e._v(" file under "),t("code",[e._v("scripts")]),e._v(" folder with bash")]),e._v(" "),t("p",[e._v("Now, let's create the "),t("code",[e._v("script_a.sh")]),e._v(" file under "),t("code",[e._v("scripts")]),e._v(" folder:")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("#!/bin/sh\ncurl curl http://ip-api.com/json\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("blockquote",[t("p",[e._v("Note: job name, script file, script file folder can all be changed with your own need.")])]),e._v(" "),t("p",[e._v("Upload the repo including "),t("code",[e._v(".gitlab-ci.yml")]),e._v(" to GitLab, it will trigger the job automatically, and you can go to "),t("code",[e._v("CI/CD - Jobs")]),e._v(" on the repo admin.")]),e._v(" "),t("p",[e._v("You can set schedule in "),t("code",[e._v("CI/CD - Schedules")]),e._v(" section. It provides options as every day, every week, every month, or customize like cron interval. You can go to https://crontab.guru to test out cron interval syntax. Technically you can set it to every minute, however, GitLab is only able to run it every hour.")]),e._v(" "),t("p",[e._v("Now, the job will only run based on your schedule settings.")]),e._v(" "),t("p",[e._v("If you go to "),t("code",[e._v("CI/CD - Jobs")]),e._v(" to check logs, you will find something like this:")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('Running with gitlab-runner 11.1.0 (081978aa)\n  on docker-auto-scale 0277ea0f\nUsing Docker executor with image ruby:2.5 ...\nPulling docker image ruby:2.5 ...\nUsing docker image sha256:1d8640b852eb145393da754ec38a4153edcf473a249448b7a271cea5f06016fa for ruby:2.5 ...\nRunning on runner-0277ea0f-project-7572283-concurrent-0 via runner-0277ea0f-srm-1532409609-e458cf74...\nCloning repository...\nCloning into \'/builds/example/scheduled-jobs\'...\nChecking out 67e03220 as master...\nSkipping Git submodules setup\n$ bash scripts/script_a.sh\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n100   463  100   463    0     0    717      0 --:--:--\n{"as":"AS15169 Google LLC","city":"Mountain View","country":"United States","countryCode":"US","isp":"Googlebot","lat":37.4192,"lon":-122.0574,"org":"Googlebot","query":"66.249.64.149","region":"CA","regionName":"California","status":"success","timezone":"America/Los_Angeles","zip":"94043"}\n --:--:-- --:--:--   716\nJob succeeded\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br")])])])},[],!1,null,null,null);a.options.__file="README.md";s.default=a.exports}}]);